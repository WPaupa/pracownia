library(metafor)
?rma
setwd('C:/Users/wojciech/Documents/pracownia')
library(ggplot2)
library(dplyr)
library(tikzDevice)
library(chemCal)
library(metafor)
df <- read.csv('radon.csv')
df <- data.frame(sapply(df1, function(col) as.numeric(gsub(",", ".", col))))
df <- data.frame(sapply(df, function(col) as.numeric(gsub(",", ".", col))))
df
df <- read.csv('radon.csv')
df <- data.frame(sapply(df, function(col) as.numeric(gsub(",", ".", col))))
df
colnames(df) <- c('n1', 'n2', 'eta', 't')
df
exp
lm(df$n1 ~ df$exp(t))
lm(df$n1 ~ exp(df$t)
lm(df$n1 ~ exp(df$t))
lm(df$n1 ~ exp(df$t))
df$t
exp(df$t)
ln
log
lA <- 3.05 * 60 * log(2)
lB <- 26.8 * 60 * log(2)
lC <- 19.8 * 60 * log(2)
df$ea = exp(-lA * df$t)
df$eb = exp(-lB * df$t)
df$ec = exp(-lC * df$t)
lm(df$n1 ~ df$ea + df$eb + df$ec)
df$n1
df$ea
df$eb
df$ec
exp(-lA * 30)
lA
lA <- log(2) / 3.05 / 60
lB <- log(2) / 26.8 / 60
lC <- log(2) / 19.8 / 60
df$ea = exp(-lA * df$t)
df$eb = exp(-lB * df$t)
df$ec = exp(-lC * df$t)
df
lm(df$n1 ~ df$ea + df$eb + df$ec)
summary(lm(df$n1 ~ df$ea + df$eb + df$ec))
linm <- lm(df$n1 ~ df$ea + df$eb + df$ec)
linm$coefficients
linm$coefficients['df$ea']
linm['df$ea']
linm$coefficients['df$ea']
linm$coefficients['df$ea'] + 1
a <- linm$coefficients['df$ea']
b <- linm$coefficients['df$eb']
c <- linm$coefficients['df$ec']
ca <- a/184
cb <- (b-139 * ca) / 1084
cc <- (c + 143 * ca + 1060 * cb) / 275
ca
cb
cc
linm$coefficients
linm$coefficients['(Intercept)']
int <- linm$coefficients['(Intercept)']
df <- read.csv('radon.csv')
df <- data.frame(sapply(df, function(col) as.numeric(gsub(",", ".", col))))
colnames(df) <- c('n1', 'n2', 'eta', 't')
lA <- log(2) / 3.05 / 60
lB <- log(2) / 26.8 / 60
lC <- log(2) / 19.8 / 60
df$ea = exp(-lA * df$t)
df$eb = exp(-lB * df$t)
df$ec = exp(-lC * df$t)
linm <- lm(df$n1 ~ df$ea + df$eb + df$ec)
a <- linm$coefficients['df$ea']
b <- linm$coefficients['df$eb']
c <- linm$coefficients['df$ec']
int <- linm$coefficients['(Intercept)']
ca <- a/184
cb <- (b-139 * ca) / 1084
cc <- (c + 143 * ca + 1060 * cb) / 275
df$pred <- df$ea * a + df$eb * b + df$ec * c + int
df$pred
ggplot(df) + geom_point(aes(x = t, y = n1)) + geom_point(aes(x = t, y = pred), color="red")
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1))
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1))$coefficients
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1))$results
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1))$estimates
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")
?rma
summary(rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE"))
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")$intrcpt
?type rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")
?rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE")
?rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$fit.stats
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$yi
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$beta
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$beta['intrcpt']
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$beta[,'intrcpt']
rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)$beta['intrcpt',]
linm <- rma(df$n1 ~ df$ea + df$eb + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)
a <- linm$beta['df$ea',]
b <- linm$beta['df$eb',]
c <- linm$beta['df$ec',]
int <- linm$beta['intrcpt',]
int
ca <- a/184
cb <- (b-139 * ca) / 1084
cc <- (c + 143 * ca + 1060 * cb) / 275
ca
ca + 1
ca * df$n1
ca
cb
cc
df$nmin = df$n1 - sqrt(df$n1)
df$nmax = df$n1 + sqrt(df$n1)
df$pred = a * df$ea + b * df$eb + c * df$ec + int
df$nmax = df$n1 + sqrt(df$n1)
df$pred
ggplot(df) + geom_point(aes(x = t, y = n1)) + geom_errorbar(aes(ymin = nmin, ymax = nmax, x = t, y = n1)) + geom_point(aes(x = t, y = pred), color="red")
ggplot(df) + geom_point(aes(x = t, y = n1)) + geom_errorbar(aes(ymin = nmin, ymax = nmax, x = t, y = n1)) + geom_smooth(aes(x = t, y = pred), color="red")
linm <- rma(df$n1 ~ df$ea + df$ec, sei = sqrt(df$n1), method="FE", intercept=FALSE)
linm
linm <- rma(df$n1 ~ df$ea, sei = sqrt(df$n1), method="FE", intercept=FALSE)
linm
counts = c(25 + 25 + 22, 8 + 10 + 13, 14 + 10 + 21, 8 + 4 + 6, 4 + 8 + 4, 6 + 5 + 3, 1 + 4 + 7, 0 + 2 + 1, 1 + 3 + 1, 0 + 0 + 1, 0 + 1 + 1, 0 + 0 + 1)
lens = 0.2 + 0.5 * (1 : length(counts))
lens
data.frame(counts, lens)
cls <- data.frame(counts, lens)
ggplot(cls, aes(y = counts, x = lens)) + geom_point()
ggplot() + geom_point(cls, mapping = aes(y = counts, x = lens))
cls[10:12]
cls[10:12,]
ggplot() + geom_point(cls, mapping = aes(y = counts, x = lens)) + geom_smooth(cls[10:12,], mapping = aes(y = counts, x = lens))
ggplot() + geom_point(cls, mapping = aes(y = counts, x = lens)) + geom_smooth(cls[10:12,], mapping = aes(y = counts, x = lens), method=lm)
ggplot() + geom_point(cls, mapping = aes(y = counts, x = lens)) + geom_smooth(cls[10:12,], mapping = aes(y = counts, x = lens), method=lm, se=FALSE)
lm(cls[10:12,]$counts ~ cls[10:12,]$lens)
ggplot() + geom_point(cls, mapping = aes(y = counts, x = lens)) + geom_hline(1.33)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_hline(1.33)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_hline(yintercept=1.33)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_errorbar() + geom_hline(yintercept=1.33)
cls$cmin = cls$counts - sqrt(cls$counts)
cls$cmax = cls$counts + sqrt(cls$counts)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_errorbar(aes(ymin = cmin, ymax = cmax)) + geom_hline(yintercept=1.33)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_errorbar(aes(ymin = 3 * cmin, ymax = 3 * cmax)) + geom_hline(yintercept=1.33)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_errorbar(aes(ymin = cmin, ymax = cmax)) + geom_hline(yintercept=1.33)
cls$cmin = cls$counts - 3 * sqrt(cls$counts)
cls$cmax = cls$counts + 3 * sqrt(cls$counts)
ggplot(cls, aes(y = counts, x = lens)) + geom_point() + geom_errorbar(aes(ymin = cmin, ymax = cmax)) + geom_hline(yintercept=1.33)
